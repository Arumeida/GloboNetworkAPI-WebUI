{% extends "template.html" %}

{% load util %}

{% block title %}[Equipamentos do Grupos de Equipamentos - Listagem]{% endblock %}

{% block header %}
<script type="text/javascript">
$(document).ready(function() {
	
	oTable = $("#egrops_list").dataTable({
		"aaSorting": [],
		"bJQueryUI": true,
		"sPaginationType": "full_numbers",
		"iDisplayLength": {% max_results %},
		"aoColumnDefs": [{ "bSortable": false, "aTargets": [ 0 ] }]
	});
	
	oTableAux = $("#ugrops_list").dataTable({
		"aaSorting": [],
		"bJQueryUI": true,
		"sPaginationType": "full_numbers",
		"iDisplayLength": {% max_results %},
		"aoColumnDefs": [{ "bSortable": false, "aTargets": [ 0 ] }]
	});
	
	$("#checkAll").click( function() {
		if ($(this).attr('checked')) {
			$(":checkbox").attr("checked", true);
		} else {
			$(":checkbox").attr("checked", false);
		}
	});
	
	$(".fg-button").live("click", function(){
		$(":checkbox").attr("checked", false);
		$(":checkbox", oTable.fnGetHiddenNodes()).attr("checked", false);
		$("#checkAll").attr("checked", false);
	});
	
	$("#page_tab").tabs();
	
	$("#page_tab_equip").tabs({ selected: {{tab}} });
	
	$("#page_tab_equip2").tabs({ selected: {{tab}} });
	
	$("#tool").buttonset();
	
	$("#btn_new").button({ icons: {primary: "ui-icon-document"} }).click(function(){
		window.open('{% url equip-group.form egroup.id %}','blank');
	});
	
	$("#btn_new_u").button({ icons: {primary: "ui-icon-document"} });
		
	{% has_perm ADMINISTRATION True None %}
	{% if has_perm %}
	$("#btn_del").button({ icons: {primary: "ui-icon-trash"} }).click(function(){
		if (confirm('Deseja realmente desassociar o(s) equipamentos do grupos de equipamentos selecionado(s)?')){ 
			var data = getSelectionData(oTable);
			$("#id_ids").val(data).parent().submit();
		}
	});
	{% endif %}
	
	{% has_perm ADMINISTRATION True None %}
	{% if has_perm %}
		$("#btn_del_u").button({ icons: {primary: "ui-icon-trash"} });
	{% endif %}
	
	$("#btn_ref").button({ icons: {primary: "ui-icon-refresh"} }).click(function(){
		location.href = "{% url equip-group.list egroup.id 0 %}";
	});
	
	$(".voltar").button({ icons: {primary: "ui-icon-arrowthick-1-w"} }).click(function(){
		location.href = "{% url group-equip.list %}";
	});
	
	$("#btn_ref_u").button({ icons: {primary: "ui-icon-refresh"} }).click(function(){
		location.href = "{% url equip-group.list egroup.id 1 %}";
	});
	
	$(".btn_edit").button({ icons: {primary: "ui-icon-pencil"}, text: false });
	$(".btn_edit", oTable.fnGetHiddenNodes()).button({ icons: {primary: "ui-icon-pencil"}, text: false });
	
})
</script>
{% endblock %}

{% block content %}
<div id="page_tab">
	<ul>
		<li><span class="ui-icon ui-icon-triangle-1-e page_tab_icon"></span><a href="#tabs-1">Detalhes do Grupo de Equipamentos</a></li>
	</ul>
	<div id="tabs-1">
		{% csrf_token %}

		<div id="fields" class="ui-widget-content">
			<table border="5">
				<tr>
					<td style="width: 120px"><label for="nome_ambiente">Nome da Grupo</label></td>
					<td><label style="width: 350px;color: blue;text-align: center;" >{{egroup.nome}}</label></td>
				</tr>
			</table>
		</div>
		
		<div class="separator spacer"></div>
		
		<div id="equip">
		
			<div id="page_tab_equip">
				<ul>
					<li><span class="ui-icon ui-icon-triangle-1-e page_tab_icon"></span><a href="#tabs-1">Equipamentos</a></li>
					<li><span class="ui-icon ui-icon-triangle-1-e page_tab_icon"></span><a href="#tabs-2">Grupo de Usários</a></li>
				</ul>
				<div id="tabs-1">
					<div class="buttons">
						<button title="voltar" class="voltar">Voltar</button>
						<button id="btn_ref" title="Atualizar dados da listagem">Atualizar</button>
						<span id="tool">
						<button id="btn_new">Novo Registro</button>
						{% has_perm ADMINISTRATION True None %}
						{% if has_perm %}
						<button id="btn_del">Excluir</button>
						{% endif %}
						</span>
					</div>
					{% has_perm ADMINISTRATION True None %}
					{% if has_perm %}
					<form id="delete_form" method="post" action="{% url equip-group.delete egroup.id  %}" style="visibility: hidden;">
						{% csrf_token %}
						{% for field in form %}
							{{ field }}
						{% endfor %}
					</form>
					{% endif %}
					<table id="egrops_list">
						<thead>
							<tr>
								<th><input id="checkAll" type="checkbox" /></th>
								<th>Nome</th>
								<th>Tipo de equipamento</th>
								<th>Modelo</th>
								<th>Marca</th>
							</tr>
						</thead>
						<tbody>
							{% for equip in equipments %}
							<tr>
								<td class="text_center"><input type="checkbox" name="selection" value="{{ equip.id }}" /></td>
								<td class="text_center">{{ equip.nome }}</td>
								<td class="text_center">{{ equip.type.tipo_equipamento }}</td>
								<td class="text_center">{{ equip.model.nome }}</td>
								<td class="text_center">{{ equip.mark.nome }}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			
			
				
				<!-- ----------------------------------------------------- -->
				
			<div id="tabs-2">
		
		
				<div class="buttons">
						<button title="voltar" class="voltar">Voltar</button>
						<button id="btn_ref_u" title="Atualizar dados da listagem">Atualizar</button>
						<span id="tool">
						<button id="btn_new_u">Novo Registro</button>
						{% has_perm ADMINISTRATION True None %}
						{% if has_perm %}
						<button id="btn_del_u">Excluir</button>
						{% endif %}
						</span>
					</div>
					{% has_perm ADMINISTRATION True None %}
					{% if has_perm %}
					<form id="delete_form_u" method="post" action="" style="visibility: hidden;">
						{% csrf_token %}
						{% for field in form_ugroup %}
							{{ field }}
						{% endfor %}
					</form>
					{% endif %}
					<table id="ugrops_list">
						<thead>
							<tr>
								<th><input id="checkAll" type="checkbox" /></th>
								<th>Nome Grupo Usuário</th>
								<th>Alterar Configuração</th>
								<th>Escrita</th>
								<th>Leitura</th>
								<th>Exclusão</th>
							</tr>
						</thead>
						<tbody>
						
							{% for ugroup in ugroups %}
							<tr>
								<td class="text_center"><input type="checkbox" name="selection" value="{{ equip.id }}" /></td>
								<td class="text_center"> {{ ugroup.nome_grupo_usuario }}</td>
								<td class="text_center">  {% ifequal  ugroup.alterar_config "1" %} <span class="ui-icon ui-icon-check text_center" title="SIM"></span> {% else %} <span class="ui-icon ui-icon-close text_center" title="NÃO"></span> {% endifequal %} </td>
								<td class="text_center">  {% ifequal ugroup.escrita "1" %} <span class="ui-icon ui-icon-check text_center" title="SIM"></span> {% else %} <span class="ui-icon ui-icon-close text_center" title="NÃO"></span> {% endifequal %} </td>
								<td class="text_center">  {% ifequal ugroup.leitura "1" %} <span class="ui-icon ui-icon-check text_center" title="SIM"></span> {% else %} <span class="ui-icon ui-icon-close text_center" title="NÃO"></span> {% endifequal %} </td>
								<td class="text_center">  {% ifequal ugroup.exclusao "1" %} <span class="ui-icon ui-icon-check text_center" title="SIM"></span> {% else %} <span class="ui-icon ui-icon-close text_center" title="NÃO"></span> {% endifequal %} </td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
			</div>
		</div>
		
	</div>
				
{% endblock %}